CKEDITOR.DIALOG_RESIZE_NONE=0;CKEDITOR.DIALOG_RESIZE_WIDTH=1;CKEDITOR.DIALOG_RESIZE_HEIGHT=2;CKEDITOR.DIALOG_RESIZE_BOTH=3;(function(){var g=CKEDITOR.tools.cssLength;function e(E){return !!this._.tabs[E][0].$.offsetHeight}function p(){var F=this._.currentTabId,H=this._.tabIdList.length,E=CKEDITOR.tools.indexOf(this._.tabIdList,F)+H;for(var G=E-1;G>E-H;G--){if(e.call(this,this._.tabIdList[G%H])){return this._.tabIdList[G%H]}}return null}function y(){var F=this._.currentTabId,H=this._.tabIdList.length,E=CKEDITOR.tools.indexOf(this._.tabIdList,F);for(var G=E+1;G<E+H;G++){if(e.call(this,this._.tabIdList[G%H])){return this._.tabIdList[G%H]}}return null}function q(F,H){var E=F.$.getElementsByTagName("input");for(var G=0,J=E.length;G<J;G++){var I=new CKEDITOR.dom.element(E[G]);if(I.getAttribute("type").toLowerCase()=="text"){if(H){I.setAttribute("value",I.getCustomData("fake_value")||"");I.removeCustomData("fake_value")}else{I.setCustomData("fake_value",I.getAttribute("value"));I.setAttribute("value","")}}}}CKEDITOR.dialog=function(H,L){var I=CKEDITOR.dialog._.dialogDefinitions[L],V=CKEDITOR.tools.clone(s),ab=H.config.dialog_buttonsOrder||"OS",O=H.lang.dir;if((ab=="OS"&&CKEDITOR.env.mac)||(ab=="rtl"&&O=="ltr")||(ab=="ltr"&&O=="rtl")){V.buttons.reverse()}I=CKEDITOR.tools.extend(I(H),V);I=CKEDITOR.tools.clone(I);I=new r(this,I);var ac=CKEDITOR.document;var T=H.theme.buildDialog(H);this._={editor:H,element:T.element,name:L,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:false,focusList:[],currentFocusIndex:0,hasFocus:false};this.parts=T.parts;CKEDITOR.tools.setTimeout(function(){H.fire("ariaWidget",this.parts.contents)},0,this);var Z={position:CKEDITOR.env.ie6Compat?"absolute":"fixed",top:0,visibility:"hidden"};Z[O=="rtl"?"right":"left"]=0;this.parts.dialog.setStyles(Z);CKEDITOR.event.call(this);this.definition=I=CKEDITOR.fire("dialogDefinition",{name:L,definition:I},H).definition;var G={};if(!("removeDialogTabs" in H._)&&H.config.removeDialogTabs){var Y=H.config.removeDialogTabs.split(";");for(U=0;U<Y.length;U++){var Q=Y[U].split(":");if(Q.length==2){var F=Q[0];if(!G[F]){G[F]=[]}G[F].push(Q[1])}}H._.removeDialogTabs=G}if(H._.removeDialogTabs&&(G=H._.removeDialogTabs[L])){for(U=0;U<G.length;U++){I.removeContents(G[U])}}if(I.onLoad){this.on("load",I.onLoad)}if(I.onShow){this.on("show",I.onShow)}if(I.onHide){this.on("hide",I.onHide)}if(I.onOk){this.on("ok",function(ad){H.fire("saveSnapshot");setTimeout(function(){H.fire("saveSnapshot")},0);if(I.onOk.call(this,ad)===false){ad.data.hide=false}})}if(I.onCancel){this.on("cancel",function(ad){if(I.onCancel.call(this,ad)===false){ad.data.hide=false}})}var aa=this;var R=function(ah){var ag=aa._.contents,af=false;for(var ae in ag){for(var ad in ag[ae]){af=ah.call(this,ag[ae][ad]);if(af){return}}}};this.on("ok",function(ad){R(function(ae){if(ae.validate){var af=ae.validate(this);if(typeof af=="string"){alert(af);af=false}if(af===false){if(ae.select){ae.select()}else{ae.focus()}ad.data.hide=false;ad.stop();return true}}})},this,null,0);this.on("cancel",function(ad){R(function(ae){if(ae.isChanged()){if(!confirm(H.lang.common.confirmCancel)){ad.data.hide=false}return true}})},this,null,0);this.parts.close.on("click",function(ad){if(this.fire("cancel",{hide:true}).hide!==false){this.hide()}ad.data.preventDefault()},this);function N(){var af=aa._.focusList;af.sort(function(ah,ag){if(ah.tabIndex!=ag.tabIndex){return ag.tabIndex-ah.tabIndex}else{return ah.focusIndex-ag.focusIndex}});var ae=af.length;for(var ad=0;ad<ae;ad++){af[ad].focusIndex=ad}}function X(ae){var aj=aa._.focusList,ai=ae?1:-1;if(aj.length<1){return}var ag=aa._.currentFocusIndex;try{aj[ag].getInputElement().$.blur()}catch(af){}var ah=(ag+ai+aj.length)%aj.length,ad=ah;while(!aj[ad].isFocusable()){ad=(ad+ai+aj.length)%aj.length;if(ad==ah){break}}aj[ad].focus();if(aj[ad].type=="text"){aj[ad].select()}}this.changeFocus=X;var E;function P(ad){if(aa!=CKEDITOR.dialog._.currentTop){return}var ah=ad.data.getKeystroke(),ag=H.lang.dir=="rtl";E=0;if(ah==9||ah==CKEDITOR.SHIFT+9){var af=(ah==CKEDITOR.SHIFT+9);if(aa._.tabBarMode){var ae=af?p.call(aa):y.call(aa);aa.selectPage(ae);aa._.tabs[ae][0].focus()}else{X(!af)}E=1}else{if(ah==CKEDITOR.ALT+121&&!aa._.tabBarMode&&aa.getPageCount()>1){aa._.tabBarMode=true;aa._.tabs[aa._.currentTabId][0].focus();E=1}else{if((ah==37||ah==39)&&aa._.tabBarMode){ae=(ah==(ag?39:37)?p.call(aa):y.call(aa));aa.selectPage(ae);aa._.tabs[ae][0].focus();E=1}else{if((ah==13||ah==32)&&aa._.tabBarMode){this.selectPage(this._.currentTabId);this._.tabBarMode=false;this._.currentFocusIndex=-1;X(true);E=1}}}}if(E){ad.stop();ad.data.preventDefault()}}function K(ad){E&&ad.data.preventDefault()}var S=this._.element;this.on("show",function(){S.on("keydown",P,this,null,0);if(CKEDITOR.env.opera||(CKEDITOR.env.gecko&&CKEDITOR.env.mac)){S.on("keypress",K,this)}});this.on("hide",function(){S.removeListener("keydown",P);if(CKEDITOR.env.opera||(CKEDITOR.env.gecko&&CKEDITOR.env.mac)){S.removeListener("keypress",K)}});this.on("iframeAdded",function(ad){var ae=new CKEDITOR.dom.document(ad.data.iframe.$.contentWindow.document);ae.on("keydown",P,this,null,0)});this.on("show",function(){N();if(H.config.dialog_startupFocusTab&&aa._.pageCount>1){aa._.tabBarMode=true;aa._.tabs[aa._.currentTabId][0].focus()}else{if(!this._.hasFocus){this._.currentFocusIndex=-1;if(I.onFocus){var ae=I.onFocus.call(this);ae&&ae.focus()}else{X(true)}if(this._.editor.mode=="wysiwyg"&&CKEDITOR.env.ie){var ad=H.document.$.selection,ag=ad.createRange();if(ag){if(ag.parentElement&&ag.parentElement().ownerDocument==H.document.$||ag.item&&ag.item(0).ownerDocument==H.document.$){var af=document.body.createTextRange();af.moveToElementText(this.getElement().getFirst().$);af.collapse(true);af.select()}}}}}},this,null,4294967295);if(CKEDITOR.env.ie6Compat){this.on("load",function(ad){var af=this.getElement(),ae=af.getFirst();ae.remove();ae.appendTo(af)},this)}t(this);C(this);(new CKEDITOR.dom.text(I.title,CKEDITOR.document)).appendTo(this.parts.title);for(var U=0;U<I.contents.length;U++){var J=I.contents[U];J&&this.addPage(J)}this.parts.tabs.on("click",function(ad){var ae=ad.data.getTarget();if(ae.hasClass("cke_dialog_tab")){var af=ae.$.id;this.selectPage(af.substring(4,af.lastIndexOf("_")));if(this._.tabBarMode){this._.tabBarMode=false;this._.currentFocusIndex=-1;X(true)}ad.data.preventDefault()}},this);var M=[],W=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:I.buttons},M).getChild();this.parts.footer.setHtml(M.join(""));for(U=0;U<W.length;U++){this._.buttons[W[U].id]=W[U]}};function A(G,F,E){this.element=F;this.focusIndex=E;this.tabIndex=0;this.isFocusable=function(){return !F.getAttribute("disabled")&&F.isVisible()};this.focus=function(){G._.currentFocusIndex=this.focusIndex;this.element.focus()};F.on("keydown",function(H){if(H.data.getKeystroke() in {32:1,13:1}){this.fire("click")}});F.on("focus",function(){this.fire("mouseover")});F.on("blur",function(){this.fire("mouseout")})}CKEDITOR.dialog.prototype={destroy:function(){this.hide();this._.element.remove()},resize:(function(){return function(F,E){if(this._.contentSize&&this._.contentSize.width==F&&this._.contentSize.height==E){return}CKEDITOR.dialog.fire("resize",{dialog:this,skin:this._.editor.skinName,width:F,height:E},this._.editor);this.fire("resize",{skin:this._.editor.skinName,width:F,height:E},this._.editor);if(this._.editor.lang.dir=="rtl"&&this._.position){this._.position.x=CKEDITOR.document.getWindow().getViewPaneSize().width-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)}this._.contentSize={width:F,height:E}}})(),getSize:function(){var E=this._.element.getFirst();return{width:E.$.offsetWidth||0,height:E.$.offsetHeight||0}},move:(function(){var E;return function(M,J,I){var G=this._.element.getFirst(),K=this._.editor.lang.dir=="rtl";if(E===undefined){E=G.getComputedStyle("position")=="fixed"}if(E&&this._.position&&this._.position.x==M&&this._.position.y==J){return}this._.position={x:M,y:J};if(!E){var L=CKEDITOR.document.getWindow().getScrollPosition();M+=L.x;J+=L.y}if(K){var F=this.getSize(),H=CKEDITOR.document.getWindow().getViewPaneSize();M=H.width-F.width-M}var N={top:(J>0?J:0)+"px"};N[K?"right":"left"]=(M>0?M:0)+"px";G.setStyles(N);I&&(this._.moved=1)}})(),getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var G=this._.element;var F=this.definition;if(!(G.getParent()&&G.getParent().equals(CKEDITOR.document.getBody()))){G.appendTo(CKEDITOR.document.getBody())}else{G.setStyle("display","block")}if(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900){var H=this.parts.dialog;H.setStyle("position","absolute");setTimeout(function(){H.setStyle("position","fixed")},0)}this.resize(this._.contentSize&&this._.contentSize.width||F.width||F.minWidth,this._.contentSize&&this._.contentSize.height||F.height||F.minHeight);this.reset();this.selectPage(this.definition.contents[0].id);if(CKEDITOR.dialog._.currentZIndex===null){CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex}this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex+=10);if(CKEDITOR.dialog._.currentTop===null){CKEDITOR.dialog._.currentTop=this;this._.parentDialog=null;h(this._.editor);G.on("keydown",m);G.on(CKEDITOR.env.opera?"keypress":"keyup",w);for(var I in {keyup:1,keydown:1,keypress:1}){G.on(I,B)}}else{this._.parentDialog=CKEDITOR.dialog._.currentTop;var E=this._.parentDialog.getElement().getFirst();E.$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2);CKEDITOR.dialog._.currentTop=this}k(this,this,"\x1b",null,function(){this.getButton("cancel")&&this.getButton("cancel").click()});this._.hasFocus=false;CKEDITOR.tools.setTimeout(function(){this.layout();this.parts.dialog.setStyle("visibility","");this.fireOnce("load",{});CKEDITOR.ui.fire("ready",this);this.fire("show",{});this._.editor.fire("dialogShow",this);this.foreach(function(J){J.setInitValue&&J.setInitValue()})},100,this)},layout:function(){var F=CKEDITOR.document.getWindow().getViewPaneSize(),E=this.getSize();this.move(this._.moved?this._.position.x:(F.width-E.width)/2,this._.moved?this._.position.y:(F.height-E.height)/2)},foreach:function(G){for(var F in this._.contents){for(var E in this._.contents[F]){G(this._.contents[F][E])}}return this},reset:(function(){var E=function(F){if(F.reset){F.reset(1)}};return function(){this.foreach(E);return this}})(),setupContent:function(){var E=arguments;this.foreach(function(F){if(F.setup){F.setup.apply(F,E)}})},commitContent:function(){var E=arguments;this.foreach(function(F){if(F.commit){F.commit.apply(F,E)}})},hide:function(){if(!this.parts.dialog.isVisible()){return}this.fire("hide",{});this._.editor.fire("dialogHide",this);var F=this._.element;F.setStyle("display","none");this.parts.dialog.setStyle("visibility","hidden");j(this);while(CKEDITOR.dialog._.currentTop!=this){CKEDITOR.dialog._.currentTop.hide()}if(!this._.parentDialog){n()}else{var E=this._.parentDialog.getElement().getFirst();E.setStyle("z-index",parseInt(E.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}CKEDITOR.dialog._.currentTop=this._.parentDialog;if(!this._.parentDialog){CKEDITOR.dialog._.currentZIndex=null;F.removeListener("keydown",m);F.removeListener(CKEDITOR.env.opera?"keypress":"keyup",w);for(var I in {keyup:1,keydown:1,keypress:1}){F.removeListener(I,B)}var H=this._.editor;H.focus();if(H.mode=="wysiwyg"&&CKEDITOR.env.ie){var G=H.getSelection();G&&G.unlock(true)}}else{CKEDITOR.dialog._.currentZIndex-=10}delete this._.parentDialog;this.foreach(function(J){J.resetInitValue&&J.resetInitValue()})},addPage:function(K){var H=[],L=K.label?' title="'+CKEDITOR.tools.htmlEncode(K.label)+'"':"",E=K.elements,O=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:K.elements,expand:!!K.expand,padding:K.padding,style:K.style||"width: 100%;height:100%"},H);var N=CKEDITOR.dom.element.createFromHtml(H.join(""));N.setAttribute("role","tabpanel");var M=CKEDITOR.env;var G="cke_"+K.id+"_"+CKEDITOR.tools.getNextNumber(),I=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',(this._.pageCount>0?" cke_last":"cke_first"),L,(!!K.hidden?' style="display:none"':""),' id="',G,'"',M.gecko&&M.version>=10900&&!M.hc?"":' href="javascript:void(0)"',' tabIndex="-1"',' hidefocus="true"',' role="tab">',K.label,"</a>"].join(""));N.setAttribute("aria-labelledby",G);this._.tabs[K.id]=[I,N];this._.tabIdList.push(K.id);!K.hidden&&this._.pageCount++;this._.lastTab=I;this.updateStyle();var J=this._.contents[K.id]={},P,F=O.getChild();while((P=F.shift())){J[P.id]=P;if(typeof(P.getChild)=="function"){F.push.apply(F,P.getChild())}}N.setAttribute("name",K.id);N.appendTo(this.parts.contents);I.unselectable();this.parts.tabs.append(I);if(K.accessKey){k(this,this,"CTRL+"+K.accessKey,D,f);this._.accessKeyMap["CTRL+"+K.accessKey]=K.id}},selectPage:function(I){if(this._.currentTabId==I){return}if(this.fire("selectPage",{page:I,currentPage:this._.currentTabId})===true){return}for(var E in this._.tabs){var G=this._.tabs[E][0],H=this._.tabs[E][1];if(E!=I){G.removeClass("cke_dialog_tab_selected");H.hide()}H.setAttribute("aria-hidden",E!=I)}var F=this._.tabs[I];F[0].addClass("cke_dialog_tab_selected");if(CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat){q(F[1]);F[1].show();setTimeout(function(){q(F[1],1)},0)}else{F[1].show()}this._.currentTabId=I;this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,I)},updateStyle:function(){this.parts.dialog[(this._.pageCount===1?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(F){var E=this._.tabs[F]&&this._.tabs[F][0];if(!E||this._.pageCount==1||!E.isVisible()){return}else{if(F==this._.currentTabId){this.selectPage(p.call(this))}}E.hide();this._.pageCount--;this.updateStyle()},showPage:function(F){var E=this._.tabs[F]&&this._.tabs[F][0];if(!E){return}E.show();this._.pageCount++;this.updateStyle()},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(F,E){var G=this._.contents[F];return G&&G[E]},getValueOf:function(F,E){return this.getContentElement(F,E).getValue()},setValueOf:function(F,E,G){return this.getContentElement(F,E).setValue(G)},getButton:function(E){return this._.buttons[E]},click:function(E){return this._.buttons[E].click()},disableButton:function(E){return this._.buttons[E].disable()},enableButton:function(E){return this._.buttons[E].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(G,E){if(typeof E=="undefined"){E=this._.focusList.length;this._.focusList.push(new A(this,G,E))}else{this._.focusList.splice(E,0,new A(this,G,E));for(var F=E+1;F<this._.focusList.length;F++){this._.focusList[F].focusIndex++}}}};CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(E,F){if(!this._.dialogDefinitions[E]||typeof F=="function"){this._.dialogDefinitions[E]=F}},exists:function(E){return !!this._.dialogDefinitions[E]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},okButton:(function(){var E=function(G,F){F=F||{};return CKEDITOR.tools.extend({id:"ok",type:"button",label:G.lang.common.ok,"class":"cke_dialog_ui_button_ok",onClick:function(H){var I=H.data.dialog;if(I.fire("ok",{hide:true}).hide!==false){I.hide()}}},F,true)};E.type="button";E.override=function(F){return CKEDITOR.tools.extend(function(G){return E(G,F)},{type:"button"},true)};return E})(),cancelButton:(function(){var E=function(G,F){F=F||{};return CKEDITOR.tools.extend({id:"cancel",type:"button",label:G.lang.common.cancel,"class":"cke_dialog_ui_button_cancel",onClick:function(H){var I=H.data.dialog;if(I.fire("cancel",{hide:true}).hide!==false){I.hide()}}},F,true)};E.type="button";E.override=function(F){return CKEDITOR.tools.extend(function(G){return E(G,F)},{type:"button"},true)};return E})(),addUIElement:function(F,E){this._.uiElementBuilders[F]=E}});CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null};CKEDITOR.event.implementOn(CKEDITOR.dialog);CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype,true);var s={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]};var x=function(J,I,H){for(var F=0,G;(G=J[F]);F++){if(G.id==I){return G}if(H&&G[H]){var E=x(G[H],I,H);if(E){return E}}}return null};var c=function(L,G,K,I,J){if(K){for(var F=0,H;(H=L[F]);F++){if(H.id==K){L.splice(F,0,G);return G}if(I&&H[I]){var E=c(H[I],G,K,I,true);if(E){return E}}}if(J){return null}}L.push(G);return G};var i=function(J,I,H){for(var F=0,G;(G=J[F]);F++){if(G.id==I){return J.splice(F,1)}if(H&&G[H]){var E=i(G[H],I,H);if(E){return E}}}return null};var r=function(F,I){this.dialog=F;var H=I.contents;for(var E=0,G;(G=H[E]);E++){H[E]=G&&new b(F,G)}CKEDITOR.tools.extend(this,I)};r.prototype={getContents:function(E){return x(this.contents,E)},getButton:function(E){return x(this.buttons,E)},addContents:function(E,F){return c(this.contents,E,F)},addButton:function(E,F){return c(this.buttons,E,F)},removeContents:function(E){i(this.contents,E)},removeButton:function(E){i(this.buttons,E)}};function b(E,F){this._={dialog:E};CKEDITOR.tools.extend(this,F)}b.prototype={get:function(E){return x(this.elements,E,"children")},add:function(F,E){return c(this.elements,F,E,"children")},remove:function(E){i(this.elements,E,"children")}};function t(J){var G=null,L=null,F=J.getElement().getFirst(),H=J.getParentEditor(),E=H.config.dialog_magnetDistance,K=H.skin.margins||[0,0,0,0];if(typeof E=="undefined"){E=20}function I(T){var N=J.getSize(),Q=CKEDITOR.document.getWindow().getViewPaneSize(),S=T.data.$.screenX,R=T.data.$.screenY,V=S-G.x,U=R-G.y,P,O;G={x:S,y:R};L.x+=V;L.y+=U;if(L.x+K[3]<E){P=-K[3]}else{if(L.x-K[1]>Q.width-N.width-E){P=Q.width-N.width+(H.lang.dir=="rtl"?0:K[1])}else{P=L.x}}if(L.y+K[0]<E){O=-K[0]}else{if(L.y-K[2]>Q.height-N.height-E){O=Q.height-N.height+K[2]}else{O=L.y}}J.move(P,O,1);T.data.preventDefault()}function M(N){CKEDITOR.document.removeListener("mousemove",I);CKEDITOR.document.removeListener("mouseup",M);if(CKEDITOR.env.ie6Compat){var O=u.getChild(0).getFrameDocument();O.removeListener("mousemove",I);O.removeListener("mouseup",M)}}J.parts.title.on("mousedown",function(N){G={x:N.data.$.screenX,y:N.data.$.screenY};CKEDITOR.document.on("mousemove",I);CKEDITOR.document.on("mouseup",M);L=J.getPosition();if(CKEDITOR.env.ie6Compat){var O=u.getChild(0).getFrameDocument();O.on("mousemove",I);O.on("mouseup",M)}N.data.preventDefault()},J)}function C(K){var F=K.definition,E=F.resizable;if(E==CKEDITOR.DIALOG_RESIZE_NONE){return}var J=K.getParentEditor();var H,G,L,N,O,Q;var M=CKEDITOR.tools.addFunction(function(S){O=K.getSize();var T=K.parts.contents,R=T.$.getElementsByTagName("iframe").length;if(R){Q=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>');T.append(Q)}G=O.height-K.parts.contents.getSize("height",!(CKEDITOR.env.gecko||CKEDITOR.env.opera||CKEDITOR.env.ie&&CKEDITOR.env.quirks));H=O.width-K.parts.contents.getSize("width",1);N={x:S.screenX,y:S.screenY};L=CKEDITOR.document.getWindow().getViewPaneSize();CKEDITOR.document.on("mousemove",I);CKEDITOR.document.on("mouseup",P);if(CKEDITOR.env.ie6Compat){var U=u.getChild(0).getFrameDocument();U.on("mousemove",I);U.on("mouseup",P)}S.preventDefault&&S.preventDefault()});K.on("load",function(){var R="";if(E==CKEDITOR.DIALOG_RESIZE_WIDTH){R=" cke_resizer_horizontal"}else{if(E==CKEDITOR.DIALOG_RESIZE_HEIGHT){R=" cke_resizer_vertical"}}var S=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+R+" cke_resizer_"+J.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(J.lang.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+M+', event )"></div>');K.parts.footer.append(S,1)});J.on("destroy",function(){CKEDITOR.tools.removeFunction(M)});function I(Y){var W=J.lang.dir=="rtl",ab=(Y.data.$.screenX-N.x)*(W?-1:1),aa=Y.data.$.screenY-N.y,R=O.width,Z=O.height,S=R+ab*(K._.moved?1:2),U=Z+aa*(K._.moved?1:2),T=K._.element.getFirst(),X=W&&T.getComputedStyle("right"),V=K.getPosition();if(V.y+U>L.height){U=L.height-V.y}if((W?X:V.x)+S>L.width){S=L.width-(W?X:V.x)}if((E==CKEDITOR.DIALOG_RESIZE_WIDTH||E==CKEDITOR.DIALOG_RESIZE_BOTH)){R=Math.max(F.minWidth||0,S-H)}if(E==CKEDITOR.DIALOG_RESIZE_HEIGHT||E==CKEDITOR.DIALOG_RESIZE_BOTH){Z=Math.max(F.minHeight||0,U-G)}K.resize(R,Z);if(!K._.moved){K.layout()}Y.data.preventDefault()}function P(){CKEDITOR.document.removeListener("mouseup",P);CKEDITOR.document.removeListener("mousemove",I);if(Q){Q.remove();Q=null}if(CKEDITOR.env.ie6Compat){var R=u.getChild(0).getFrameDocument();R.removeListener("mouseup",P);R.removeListener("mousemove",I)}}}var o;var l={},u;function z(E){E.data.preventDefault(1)}function h(M){var L=CKEDITOR.document.getWindow();var F=M.config,N=F.dialog_backgroundCoverColor||"white",H=F.dialog_backgroundCoverOpacity,O=F.baseFloatZIndex,Q=CKEDITOR.tools.genKey(N,H,O),G=l[Q];if(!G){var K=['<div tabIndex="-1" style="position: ',(CKEDITOR.env.ie6Compat?"absolute":"fixed"),"; z-index: ",O,"; top: 0px; left: 0px; ",(!CKEDITOR.env.ie6Compat?"background-color: "+N:""),'" class="cke_dialog_background_cover">'];if(CKEDITOR.env.ie6Compat){var J=CKEDITOR.env.isCustomDomain(),P="<html><body style=\\'background-color:"+N+";\\'></body></html>";K.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:');K.push("void((function(){document.open();"+(J?"document.domain='"+document.domain+"';":"")+"document.write( '"+P+"' );document.close();})())");K.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')}K.push("</div>");G=CKEDITOR.dom.element.createFromHtml(K.join(""));G.setOpacity(H!=undefined?H:0.5);G.on("keydown",z);G.on("keypress",z);G.on("keyup",z);G.appendTo(CKEDITOR.document.getBody());l[Q]=G}else{G.show()}u=G;var R=function(){var S=L.getViewPaneSize();G.setStyles({width:S.width+"px",height:S.height+"px"})};var I=function(){var U=L.getScrollPosition(),T=CKEDITOR.dialog._.currentTop;G.setStyles({left:U.x+"px",top:U.y+"px"});if(T){do{var S=T.getPosition();T.move(S.x,S.y)}while((T=T._.parentDialog))}};o=R;L.on("resize",R);R();if(!(CKEDITOR.env.mac&&CKEDITOR.env.webkit)){G.focus()}if(CKEDITOR.env.ie6Compat){var E=function(){I();arguments.callee.prevScrollHandler.apply(this,arguments)};L.$.setTimeout(function(){E.prevScrollHandler=window.onscroll||function(){};window.onscroll=E},0);I()}}function n(){if(!u){return}var E=CKEDITOR.document.getWindow();u.hide();E.removeListener("resize",o);if(CKEDITOR.env.ie6Compat){E.$.setTimeout(function(){var F=window.onscroll&&window.onscroll.prevScrollHandler;window.onscroll=F||null},0)}o=null}function d(){for(var E in l){l[E].remove()}l={}}var v={};var m=function(G){var I=G.data.$.ctrlKey||G.data.$.metaKey,J=G.data.$.altKey,F=G.data.$.shiftKey,H=String.fromCharCode(G.data.$.keyCode),E=v[(I?"CTRL+":"")+(J?"ALT+":"")+(F?"SHIFT+":"")+H];if(!E||!E.length){return}E=E[E.length-1];E.keydown&&E.keydown.call(E.uiElement,E.dialog,E.key);G.data.preventDefault()};var w=function(G){var I=G.data.$.ctrlKey||G.data.$.metaKey,J=G.data.$.altKey,F=G.data.$.shiftKey,H=String.fromCharCode(G.data.$.keyCode),E=v[(I?"CTRL+":"")+(J?"ALT+":"")+(F?"SHIFT+":"")+H];if(!E||!E.length){return}E=E[E.length-1];if(E.keyup){E.keyup.call(E.uiElement,E.dialog,E.key);G.data.preventDefault()}};var k=function(E,G,F,H,J){var I=v[F]||(v[F]=[]);I.push({uiElement:E,dialog:G,key:F,keyup:J||E.accessKeyUp,keydown:H||E.accessKeyDown})};var j=function(H){for(var F in v){var G=v[F];for(var E=G.length-1;E>=0;E--){if(G[E].dialog==H||G[E].uiElement==H){G.splice(E,1)}}if(G.length===0){delete v[F]}}};var f=function(F,E){if(F._.accessKeyMap[E]){F.selectPage(F._.accessKeyMap[E])}};var D=function(F,E){};var a={27:1,13:1};var B=function(E){if(E.data.getKeystroke() in a){E.data.stopPropagation()}};(function(){CKEDITOR.ui.dialog={uiElement:function(V,Q,R,H,T,F,G){if(arguments.length<4){return}var E=(H.call?H(Q):H)||"div",O=["<",E," "],N=(T&&T.call?T(Q):T)||{},M=(F&&F.call?F(Q):F)||{},K=(G&&G.call?G.call(this,V,Q):G)||"",J=this.domId=M.id||CKEDITOR.tools.getNextId()+"_uiElement",S=this.id=Q.id,U;M.id=J;var W={};if(Q.type){W["cke_dialog_ui_"+Q.type]=1}if(Q.className){W[Q.className]=1}if(Q.disabled){W.cke_disabled=1}var L=(M["class"]&&M["class"].split)?M["class"].split(" "):[];for(U=0;U<L.length;U++){if(L[U]){W[L[U]]=1}}var I=[];for(U in W){I.push(U)}M["class"]=I.join(" ");if(Q.title){M.title=Q.title}var P=(Q.style||"").split(";");for(U in N){P.push(U+":"+N[U])}if(Q.hidden){P.push("display:none")}for(U=P.length-1;U>=0;U--){if(P[U]===""){P.splice(U,1)}}if(P.length>0){M.style=(M.style?(M.style+"; "):"")+P.join("; ")}for(U in M){O.push(U+'="'+CKEDITOR.tools.htmlEncode(M[U])+'" ')}O.push(">",K,"</",E,">");R.push(O.join(""));(this._||(this._={})).dialog=V;if(typeof(Q.isChanged)=="boolean"){this.isChanged=function(){return Q.isChanged}}if(typeof(Q.isChanged)=="function"){this.isChanged=Q.isChanged}CKEDITOR.event.implementOn(this);this.registerEvents(Q);if(this.accessKeyUp&&this.accessKeyDown&&Q.accessKey){k(this,V,"CTRL+"+Q.accessKey)}var X=this;V.on("load",function(){if(X.getInputElement()){X.getInputElement().on("focus",function(){V._.tabBarMode=false;V._.hasFocus=true;X.fire("focus")},X)}});if(this.keyboardFocusable){this.tabIndex=Q.tabIndex||0;this.focusIndex=V._.focusList.push(this)-1;this.on("focus",function(){V._.currentFocusIndex=X.focusIndex})}CKEDITOR.tools.extend(this,Q)},hbox:function(K,O,P,G,F){if(arguments.length<4){return}this._||(this._={});var H=this._.children=O,I=F&&F.widths||null,M=F&&F.height||null,N={},J;var L=function(){var Q=['<tbody><tr class="cke_dialog_ui_hbox">'];for(J=0;J<P.length;J++){var R="cke_dialog_ui_hbox_child",S=[];if(J===0){R="cke_dialog_ui_hbox_first"}if(J==P.length-1){R="cke_dialog_ui_hbox_last"}Q.push('<td class="',R,'" role="presentation" ');if(I){if(I[J]){S.push("width:"+g(I[J]))}}else{S.push("width:"+Math.floor(100/P.length)+"%")}if(M){S.push("height:"+g(M))}if(F&&F.padding!=undefined){S.push("padding:"+g(F.padding))}if(S.length>0){Q.push('style="'+S.join("; ")+'" ')}Q.push(">",P[J],"</td>")}Q.push("</tr></tbody>");return Q.join("")};var E={role:"presentation"};F&&F.align&&(E.align=F.align);CKEDITOR.ui.dialog.uiElement.call(this,K,F||{type:"hbox"},G,"table",N,E,L)},vbox:function(I,L,M,G,E){if(arguments.length<3){return}this._||(this._={});var H=this._.children=L,F=E&&E.width||null,J=E&&E.heights||null;var K=function(){var O=['<table role="presentation" cellspacing="0" border="0" '];O.push('style="');if(E&&E.expand){O.push("height:100%;")}O.push("width:"+g(F||"100%"),";");O.push('"');O.push('align="',CKEDITOR.tools.htmlEncode((E&&E.align)||(I.getParentEditor().lang.dir=="ltr"?"left":"right")),'" ');O.push("><tbody>");for(var N=0;N<M.length;N++){var P=[];O.push('<tr><td role="presentation" ');if(F){P.push("width:"+g(F||"100%"))}if(J){P.push("height:"+g(J[N]))}else{if(E&&E.expand){P.push("height:"+Math.floor(100/M.length)+"%")}}if(E&&E.padding!=undefined){P.push("padding:"+g(E.padding))}if(P.length>0){O.push('style="',P.join("; "),'" ')}O.push(' class="cke_dialog_ui_vbox_child">',M[N],"</td></tr>")}O.push("</tbody></table>");return O.join("")};CKEDITOR.ui.dialog.uiElement.call(this,I,E||{type:"vbox"},G,"div",null,{role:"presentation"},K)}}})();CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(F,E){this.getInputElement().setValue(F);!E&&this.fire("change",{value:F});return this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return false},selectParentTab:function(){var F=this.getInputElement(),G=F,E;while((G=G.getParent())&&G.$.className.search("cke_dialog_page_contents")==-1){}if(!G){return this}E=G.getAttribute("name");if(this._.dialog._.currentTabId!=E){this._.dialog.selectPage(E)}return this},focus:function(){this.selectParentTab().getInputElement().focus();return this},registerEvents:function(G){var H=/^on([A-Z]\w+)/,E;var I=function(K,L,J,M){L.on("load",function(){K.getInputElement().on(J,M,K)})};for(var F in G){if(!(E=F.match(H))){continue}if(this.eventProcessors[F]){this.eventProcessors[F].call(this,this._.dialog,G[F])}else{I(this,this._.dialog,E[1].toLowerCase(),G[F])}}return this},eventProcessors:{onLoad:function(E,F){E.on("load",F,this)},onShow:function(E,F){E.on("show",F,this)},onHide:function(E,F){E.on("hide",F,this)}},accessKeyDown:function(F,E){this.focus()},accessKeyUp:function(F,E){},disable:function(){var E=this.getElement();E.setAttribute("disabled","true");E.addClass("cke_disabled")},enable:function(){var E=this.getElement();E.removeAttribute("disabled");E.removeClass("cke_disabled")},isEnabled:function(){return !this.getInputElement().getAttribute("disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){if(!this.isEnabled()||!this.isVisible()){return false}return true}};CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(E){if(arguments.length<1){return this._.children.concat()}if(!E.splice){E=[E]}if(E.length<2){return this._.children[E[0]]}else{return(this._.children[E[0]]&&this._.children[E[0]].getChild)?this._.children[E[0]].getChild(E.slice(1,E.length)):null}}},true);CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox();(function(){var E={build:function(L,F,I){var H=F.children,G,N=[],M=[];for(var K=0;(K<H.length&&(G=H[K]));K++){var J=[];N.push(J);M.push(CKEDITOR.dialog._.uiElementBuilders[G.type].build(L,G,J))}return new CKEDITOR.ui.dialog[F.type](L,M,N,I,F)}};CKEDITOR.dialog.addUIElement("hbox",E);CKEDITOR.dialog.addUIElement("vbox",E)})();CKEDITOR.dialogCommand=function(E){this.dialogName=E};CKEDITOR.dialogCommand.prototype={exec:function(E){E.openDialog(this.dialogName)},canUndo:false,editorFocus:CKEDITOR.env.ie||CKEDITOR.env.webkit};(function(){var F=/^([a]|[^a])+$/,E=/^\d*$/,G=/^\d*(?:\.\d+)?$/;CKEDITOR.VALIDATE_OR=1;CKEDITOR.VALIDATE_AND=2;CKEDITOR.dialog.validate={functions:function(){return function(){var J=this&&this.getValue?this.getValue():arguments[0];var L=undefined,I=CKEDITOR.VALIDATE_AND,K=[],H;for(H=0;H<arguments.length;H++){if(typeof(arguments[H])=="function"){K.push(arguments[H])}else{break}}if(H<arguments.length&&typeof(arguments[H])=="string"){L=arguments[H];H++}if(H<arguments.length&&typeof(arguments[H])=="number"){I=arguments[H]}var M=(I==CKEDITOR.VALIDATE_AND?true:false);for(H=0;H<K.length;H++){if(I==CKEDITOR.VALIDATE_AND){M=M&&K[H](J)}else{M=M||K[H](J)}}if(!M){if(L!==undefined){alert(L)}if(this&&(this.select||this.focus)){(this.select||this.focus)()}return false}return true}},regex:function(H,I){return function(){var J=this&&this.getValue?this.getValue():arguments[0];if(!H.test(J)){if(I!==undefined){alert(I)}if(this&&(this.select||this.focus)){if(this.select){this.select()}else{this.focus()}}return false}return true}},notEmpty:function(H){return this.regex(F,H)},integer:function(H){return this.regex(E,H)},number:function(H){return this.regex(G,H)},equals:function(H,I){return this.functions(function(J){return J==H},I)},notEqual:function(H,I){return this.functions(function(J){return J!=H},I)}};CKEDITOR.on("instanceDestroyed",function(I){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){var H;while((H=CKEDITOR.dialog._.currentTop)){H.hide()}d()}var K=I.editor._.storedDialogs;for(var J in K){K[J].destroy()}})})();CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(G,N){if(this.mode=="wysiwyg"&&CKEDITOR.env.ie){var K=this.getSelection();K&&K.lock()}var F=CKEDITOR.dialog._.dialogDefinitions[G],E=this.skin.dialog;if(CKEDITOR.dialog._.currentTop===null){h(this)}if(typeof F=="function"&&E._isLoaded){var L=this._.storedDialogs||(this._.storedDialogs={});var I=L[G]||(L[G]=new CKEDITOR.dialog(this,G));N&&N.call(I,I);I.show();return I}else{if(F=="failed"){n();throw new Error('[CKEDITOR.dialog.openDialog] Dialog "'+G+'" failed when loading definition.')}}var J=this;function H(P){var Q=CKEDITOR.dialog._.dialogDefinitions[G],O=J.skin.dialog;if(!O._isLoaded||M&&typeof P=="undefined"){return}if(typeof Q!="function"){CKEDITOR.dialog._.dialogDefinitions[G]="failed"}J.openDialog(G,N)}if(typeof F=="string"){var M=1;CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(F),H,null,0,1)}CKEDITOR.skins.load(this,"dialog",H);return null}})})();CKEDITOR.plugins.add("dialog",{requires:["dialogui"]});